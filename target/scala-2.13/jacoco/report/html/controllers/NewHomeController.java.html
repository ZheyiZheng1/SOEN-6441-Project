<?xml version="1.0" encoding="utf-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>NewHomeController.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=2;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Jacoco Coverage Report</a> &gt; <a href="index.source.html" class="el_package">controllers</a> &gt; <span class="el_source">NewHomeController.java</span></div><h1>NewHomeController.java</h1><pre class="source lang-java linenums">package controllers;

import actors.ReadabilityActor;
import akka.actor.ActorRef;
import akka.actor.ActorSystem;
import akka.stream.Materializer;
import play.mvc.Controller;
import play.mvc.Result;
import play.mvc.WebSocket;
import javax.inject.Inject;
import akka.actor.Props;
import play.libs.F.Either;
import play.libs.streams.ActorFlow;
import java.util.concurrent.CompletableFuture;
import actors.APIActor;
import actors.WebSocketActor;

/**
 * @author: Zheyi Zheng - 40266266
 * Created: 2024/11/14
 * This is the NewHomeController class. This is the only controller we use in project 2.
 */
public class NewHomeController extends Controller {

    private final ActorSystem actorSystem;
    private final Materializer materializer;

    /**
     * @author: Zheyi Zheng - 40266266
     * Created: 2024/11/14
     * This is the constructor method.
     */
    @Inject
<span class="nc" id="L34">    public NewHomeController(ActorSystem actorSystem, Materializer materializer) {</span>
<span class="nc" id="L35">        this.actorSystem = actorSystem;</span>
<span class="nc" id="L36">        this.materializer = materializer;</span>
<span class="nc" id="L37">    }</span>

    /**
     * @author: Zheyi Zheng - 40266266
     * Created: 2024/11/14
     * This is the index method. This method make sure user can reach the index page with on data correctly.
     * @return  Result standard return value in Play framework.
     */
    public Result index(){
        // The view with only a search box
<span class="nc" id="L47">        return ok(views.html.index.render());</span>
    }

    /**
     * @author: Zheyi Zheng - 40266266
     * Created: 2024/11/14
     * This is the ws method. This method make sure program act correctly when user side request to open a websocket.
     * When user request to open a websocket with a search keyword, create an WebSocketActor to communicate with user.
     * APIActor in charge of making API call to YouTube.
     * @return WebSocket standard return for websocket.
     */
    public WebSocket ws() {
        // Create a web socket and return
<span class="nc" id="L60">        return WebSocket.Text.acceptOrResult(request -&gt; {</span>
            // Create actor
            return CompletableFuture.completedFuture(Either.Right(
                    ActorFlow.actorRef(out -&gt; WebSocketActor.props(out), actorSystem, materializer)
            ));
        });
    }
}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.7.202105040129</span></div></body></html>